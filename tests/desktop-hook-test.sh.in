#!/bin/bash

TEST_DIR=@CMAKE_CURRENT_BINARY_DIR@
SRC_DIR=@CMAKE_CURRENT_SOURCE_DIR@

CACHE_DIR=${TEST_DIR}/desktop-hook-test-click-dir
CLICK_DIR=${CACHE_DIR}/ubuntu-app-launch/desktop/

DATA_DIR=${TEST_DIR}/desktop-hook-test-apps-dir
APPS_DIR=${DATA_DIR}/applications/

# Remove the old directories
rm -rf ${CACHE_DIR}
rm -rf ${DATA_DIR}

# Copy our source applications
mkdir -p ${CLICK_DIR}
cp ${SRC_DIR}/link-farm/* ${CLICK_DIR}

# Setup the environment
export XDG_CACHE_HOME=${CACHE_DIR}
export XDG_DATA_HOME=${DATA_DIR}
export TEST_CLICK_DB=@CMAKE_CURRENT_SOURCE_DIR@/click-db-dir
export TEST_CLICK_USER=test-user

# Run the tool
@CMAKE_BINARY_DIR@/desktop-hook

# Verify the results
